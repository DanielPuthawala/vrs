$schema: http://json-schema.org/draft/2020-12/schema
title: GA4GH-GKS-Core-Definitions
type: object
strict: true

$defs:
  Entity:
    description: >-
      Entity is the root class of ‘core’ classes model - those that have identifiers and other general 
      metadata like labels, xrefs, urls, descriptions, etc. All core classes descend from and inherit 
      its attributes.
    oneOf:
      - $ref: "#/$defs/ExtensibleEntity"
      - $ref: "#/$defs/ValueEntity"
    heritable_properties:
      id:
        $ref: "#/$defs/CURIE"
        description: >-
          The 'logical' identifier of the entity in the system of record, e.g. a UUID. This 'id' is 
          unique within a given system. The identified entity may have a different 'id' in a different 
          system.
      type:
        type: string
        description: >-
          The schema class that is instantiated by the data object. Must be the name of a class from 
          the VA schema.
    heritable_required: ["type"]
    discriminator:
      propertyName: type

  ValueEntity:
    inherits: Entity
    description: >-
      ValueEntity is the root class for classes that instantiate Value Objects. ValueEntity classes
      are not extensible and MUST NOT have optional properties.
    oneOf:
      - $ref: "#/$defs/Proposition"
    discriminator:
      propertyName: type

  ExtensibleEntity:
    inherits: Entity
    description: >-
      ExtensibleEntity is the root class for classes that instantiate Extensible Objects. Extensible
      Objects are extensible using the extensions property and MAY have optional properties.
    oneOf:
      - $ref: "#/$defs/"
    heritable_properties:
      extensions:
        type: array
        items:
          $ref: "#/$defs/Extension"

  Extension:
    description: >-
      The Extension class provides VODs with a means to extend descriptions
      with other attributes unique to a content provider. These extensions
      are not expected to be natively understood under VRSATILE, but may be
      used for pre-negotiated exchange of message attributes when needed.
    properties:
      type:
        type: string
        const: Extension
        description: MUST be "Extension".
      name:
        type: string
        description: A name for the Extension
      value:
        type: [ "number", "string", "boolean", "object", "array", "null" ]
        description: Any primitive or structured object
    required: [ "type", "name" ]

  CURIE:
    description: >-
      A `W3C Compact URI <https://www.w3.org/TR/curie/>`_ formatted string.
      A CURIE string has the structure ``prefix``:``reference``, as defined by
      the W3C syntax.
    type: string
    pattern: '^\w[^:]*:.+$'
    example: "ensembl:ENSG00000139618"